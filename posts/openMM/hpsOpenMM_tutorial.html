<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quyen Vu">
<meta name="dcterms.date" content="2023-02-04">

<title>Quyen Vu - hpsOpenMM tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/QV.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><b>Quyen Vu</b></span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../pubs.html">
 <span class="menu-text"><strong>Publications</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools.html">
 <span class="menu-text"><strong>Tools</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/qvv5013"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/qvv5013"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <h1 class="title">hpsOpenMM tutorial</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">IDP</div>
                <div class="quarto-category">OpenMM</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quyen Vu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 4, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">




<section id="generate-initial-structure" class="level1">
<h1>Generate initial structure:</h1>
<p>To generate initial structure, we can use a provided script: <code>scripts/generate_structure_from_fasta/generate_structure.py</code></p>
<p>In this script, there are some parameters need to be changed:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python numberLines lineAnchors code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>seq <span class="op">=</span> <span class="st">'MRTQWPSPAKLNLFLYITGQRADGYHTLQTLFQFLDYGDTISIELRDDGDIRLLTPVEGVEHEDNLIVRAARLLMKTAADSGRLPTGSGANISIDKRLPMGGGLGGGSSNAATVLVALNHLWQCGLSMDELAEMGLTLGADVPVFVRGHAAFAEGVGEILTPVDPPEKWYLVAHPGVSIPTPVIFKDPELPRNTPKRSIETLLKCEFSNDCEVIARKRFREVDAVLSWLLEYAPSRLTGTGACVFAEFDTESEARQVLEQAPEWLNGFVAKGANLSPLHRAML'</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>protein_name <span class="op">=</span> <span class="st">"2ww4"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># number of chains = nx*ny</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>nx <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>ny <span class="op">=</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>line 1: the fasta sequence of protein we are studying</li>
<li>line 2: name of protein, will be used to write pdb output file name</li>
<li>lines 3-4: number of copies in x-y dimension, in case simulation of multichains</li>
</ul>
</section>
<section id="simulation-control-file" class="level1">
<h1>Simulation control file:</h1>
<p>Simulation control parameters are saved in *ini file format (python file format): here, I will named it as md.ini</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python numberLines lineAnchors code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>[OPTIONS]</span>
<span id="cb2-2"><a href="#cb2-2"></a>md_steps <span class="op">=</span> <span class="dv">10_000</span> <span class="co"># number of steps</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>dt <span class="op">=</span> <span class="fl">0.01</span> <span class="op">;</span> time step <span class="kw">in</span> ps</span>
<span id="cb2-4"><a href="#cb2-4"></a>nstxout <span class="op">=</span> <span class="dv">100</span> <span class="op">;</span> number of steps to write checkpoint <span class="op">=</span> nstxout</span>
<span id="cb2-5"><a href="#cb2-5"></a>nstlog <span class="op">=</span> <span class="dv">100</span> <span class="op">;</span> number of steps to <span class="bu">print</span> log</span>
<span id="cb2-6"><a href="#cb2-6"></a>nstcomm <span class="op">=</span> <span class="dv">100</span> <span class="op">;</span> frequency <span class="cf">for</span> center of mass motion removal</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="op">;</span> select HPS model, available options: hps_kr, hps_urry, <span class="kw">or</span> hps_ss</span>
<span id="cb2-8"><a href="#cb2-8"></a>model <span class="op">=</span> mpipi</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="op">;</span> control temperature coupling</span>
<span id="cb2-11"><a href="#cb2-11"></a>tcoupl <span class="op">=</span> yes</span>
<span id="cb2-12"><a href="#cb2-12"></a>ref_t <span class="op">=</span> <span class="dv">310</span> <span class="op">;</span> Kelvin<span class="op">-</span> reference temperature</span>
<span id="cb2-13"><a href="#cb2-13"></a>tau_t <span class="op">=</span> <span class="fl">0.01</span> <span class="op">;</span> ps<span class="op">^-</span><span class="dv">1</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="op">;</span>pressure coupling</span>
<span id="cb2-16"><a href="#cb2-16"></a>pcoupl <span class="op">=</span> no</span>
<span id="cb2-17"><a href="#cb2-17"></a>ref_p <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>frequency_p <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb2-19"><a href="#cb2-19"></a></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="op">;</span> Periodic boundary condition: <span class="cf">if</span> pcoupl <span class="kw">is</span> yes then pbc must be yes.</span>
<span id="cb2-21"><a href="#cb2-21"></a>pbc <span class="op">=</span> yes</span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="op">;</span> <span class="cf">if</span> pbc<span class="op">=</span>yes, then use box_dimension option to specify box_dimension <span class="op">=</span> x <span class="kw">or</span> [x, y, z], unit of nanometer</span>
<span id="cb2-23"><a href="#cb2-23"></a>box_dimension <span class="op">=</span> <span class="dv">30</span> <span class="op">;</span> [<span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">60</span>]</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="op">;</span> <span class="bu">input</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>protein_code <span class="op">=</span> ASYN</span>
<span id="cb2-27"><a href="#cb2-27"></a>pdb_file <span class="op">=</span> asyn.pdb</span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="op">;</span> output</span>
<span id="cb2-29"><a href="#cb2-29"></a>checkpoint <span class="op">=</span> asyn.chk</span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="op">;</span>Use GPU<span class="op">/</span>CPU</span>
<span id="cb2-31"><a href="#cb2-31"></a>device <span class="op">=</span> GPU</span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="op">;</span> If CPU <span class="kw">is</span> specified, then use ppn variable</span>
<span id="cb2-33"><a href="#cb2-33"></a>ppn <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="op">;</span>Restart simulation</span>
<span id="cb2-35"><a href="#cb2-35"></a>restart <span class="op">=</span> no</span>
<span id="cb2-36"><a href="#cb2-36"></a>minimize <span class="op">=</span> yes <span class="op">;</span><span class="cf">if</span> <span class="kw">not</span> restart, then minimize will be loaded, otherwise, minimize<span class="op">=</span><span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This control file is almost self-explaination if you are familiar with other MD simulation packages.</p>
</section>
<section id="running-simulation" class="level1">
<h1>Running simulation</h1>
<p>To run simulation, there are two options:</p>
<ol type="1">
<li><p>Normal canonical simulation using Langevin dynamics: <code>hps-simulation -f md.ini</code></p></li>
<li><p>If you want to customize your simulation to use some advanced methods, make a copy of <code>examples/standard_example/run_simulation.py</code> Customize the content of this script then execute the command: <code>python run_simulation -f md.ini</code></p></li>
</ol>
</section>
<section id="analyze-simulation-trajectory" class="level1">
<h1>Analyze simulation trajectory</h1>
<p>Simulation will generate a psf file for topology and dcd file for trajectory, in addition, a log file that contains potential energy, kinetics energy, total energy and time remain to run simulations. But mainly you will need to analyze the trajectory to extract the information you need.</p>
<p>In the scripts/ directory, I provided some scripts I used in my study but you may need to develop for yours.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
      </div>
  </div>
</footer>



</body></html>